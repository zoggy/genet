<html><head>
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type">
<link rel="Start" href="index.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of class attributes" rel=Appendix href="index_attributes.html">
<link title="Index of class methods" rel=Appendix href="index_methods.html">
<link title="Index of classes" rel=Appendix href="index_classes.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="Checks" rel="Chapter" href="Checks.html">
<link title="Chn_ast" rel="Chapter" href="Chn_ast.html">
<link title="Chn_diff" rel="Chapter" href="Chn_diff.html">
<link title="Chn_exec" rel="Chapter" href="Chn_exec.html">
<link title="Chn_flat" rel="Chapter" href="Chn_flat.html">
<link title="Chn_inst" rel="Chapter" href="Chn_inst.html">
<link title="Chn_inst_query" rel="Chapter" href="Chn_inst_query.html">
<link title="Chn_io" rel="Chapter" href="Chn_io.html">
<link title="Chn_lookup" rel="Chapter" href="Chn_lookup.html">
<link title="Chn_parser" rel="Chapter" href="Chn_parser.html">
<link title="Chn_run" rel="Chapter" href="Chn_run.html">
<link title="Chn_types" rel="Chapter" href="Chn_types.html">
<link title="Chngui" rel="Chapter" href="Chngui.html">
<link title="Cmdline" rel="Chapter" href="Cmdline.html">
<link title="Config" rel="Chapter" href="Config.html">
<link title="Find" rel="Chapter" href="Find.html">
<link title="Fname" rel="Chapter" href="Fname.html">
<link title="Graph" rel="Chapter" href="Graph.html">
<link title="Grdf_branch" rel="Chapter" href="Grdf_branch.html">
<link title="Grdf_constant" rel="Chapter" href="Grdf_constant.html">
<link title="Grdf_diff" rel="Chapter" href="Grdf_diff.html">
<link title="Grdf_dot" rel="Chapter" href="Grdf_dot.html">
<link title="Grdf_ftype" rel="Chapter" href="Grdf_ftype.html">
<link title="Grdf_init" rel="Chapter" href="Grdf_init.html">
<link title="Grdf_intf" rel="Chapter" href="Grdf_intf.html">
<link title="Grdf_parser" rel="Chapter" href="Grdf_parser.html">
<link title="Grdf_port" rel="Chapter" href="Grdf_port.html">
<link title="Grdf_tool" rel="Chapter" href="Grdf_tool.html">
<link title="Grdf_types" rel="Chapter" href="Grdf_types.html">
<link title="Grdf_version" rel="Chapter" href="Grdf_version.html">
<link title="Grdfs" rel="Chapter" href="Grdfs.html">
<link title="Gui_base" rel="Chapter" href="Gui_base.html">
<link title="Gui_install" rel="Chapter" href="Gui_install.html">
<link title="Gui_main" rel="Chapter" href="Gui_main.html">
<link title="Ind_io" rel="Chapter" href="Ind_io.html">
<link title="Ind_types" rel="Chapter" href="Ind_types.html">
<link title="Install" rel="Chapter" href="Install.html">
<link title="Instgui" rel="Chapter" href="Instgui.html">
<link title="Lexer" rel="Chapter" href="Lexer.html">
<link title="Loc" rel="Chapter" href="Loc.html">
<link title="Main" rel="Chapter" href="Main.html">
<link title="Main_chain" rel="Chapter" href="Main_chain.html">
<link title="Main_cheat" rel="Chapter" href="Main_cheat.html">
<link title="Main_cmd" rel="Chapter" href="Main_cmd.html">
<link title="Main_diff" rel="Chapter" href="Main_diff.html">
<link title="Main_edit" rel="Chapter" href="Main_edit.html">
<link title="Main_exec" rel="Chapter" href="Main_exec.html">
<link title="Main_genrdfs" rel="Chapter" href="Main_genrdfs.html">
<link title="Main_gui" rel="Chapter" href="Main_gui.html">
<link title="Main_init" rel="Chapter" href="Main_init.html">
<link title="Main_query" rel="Chapter" href="Main_query.html">
<link title="Main_rdf" rel="Chapter" href="Main_rdf.html">
<link title="Main_rest" rel="Chapter" href="Main_rest.html">
<link title="Misc" rel="Chapter" href="Misc.html">
<link title="Options" rel="Chapter" href="Options.html">
<link title="Reporter" rel="Chapter" href="Reporter.html">
<link title="Rest_query" rel="Chapter" href="Rest_query.html">
<link title="Rest_types" rel="Chapter" href="Rest_types.html">
<link title="Rest_xhtml" rel="Chapter" href="Rest_xhtml.html">
<link title="Rest_xpage" rel="Chapter" href="Rest_xpage.html">
<link title="Smap" rel="Chapter" href="Smap.html">
<link title="Sset" rel="Chapter" href="Sset.html">
<link title="Tokens" rel="Chapter" href="Tokens.html">
<link title="Toolgui" rel="Chapter" href="Toolgui.html">
<link title="Version" rel="Chapter" href="Version.html"><title>Genet library reference : Grdfs</title>
</head>
<body>
<code class="code"></code><table><tr><td></td><td><span class="comment">(*********************************************************************************)</span></td></tr></table><code class="code"><br>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Genet&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;Copyright&nbsp;(C)&nbsp;2012-2013&nbsp;Institut&nbsp;National&nbsp;de&nbsp;Recherche&nbsp;en&nbsp;Informatique&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;et&nbsp;en&nbsp;Automatique.&nbsp;All&nbsp;rights&nbsp;reserved.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;program&nbsp;is&nbsp;free&nbsp;software;&nbsp;you&nbsp;can&nbsp;redistribute&nbsp;it&nbsp;and/or&nbsp;modify&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;it&nbsp;under&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;GNU&nbsp;General&nbsp;Public&nbsp;License&nbsp;version&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;or&nbsp;later&nbsp;as&nbsp;published&nbsp;by&nbsp;the&nbsp;Free&nbsp;Software&nbsp;Foundation.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;program&nbsp;is&nbsp;distributed&nbsp;in&nbsp;the&nbsp;hope&nbsp;that&nbsp;it&nbsp;will&nbsp;be&nbsp;useful,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;but&nbsp;WITHOUT&nbsp;ANY&nbsp;WARRANTY;&nbsp;without&nbsp;even&nbsp;the&nbsp;implied&nbsp;warranty&nbsp;of&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;MERCHANTABILITY&nbsp;or&nbsp;FITNESS&nbsp;FOR&nbsp;A&nbsp;PARTICULAR&nbsp;PURPOSE.&nbsp;&nbsp;See&nbsp;the&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;GNU&nbsp;General&nbsp;Public&nbsp;License&nbsp;for&nbsp;more&nbsp;details.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;You&nbsp;should&nbsp;have&nbsp;received&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;GNU&nbsp;General&nbsp;Public&nbsp;License&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;along&nbsp;with&nbsp;this&nbsp;program;&nbsp;if&nbsp;not,&nbsp;write&nbsp;to&nbsp;the&nbsp;Free&nbsp;Software&nbsp;Foundation,&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;Inc.,&nbsp;59&nbsp;Temple&nbsp;Place,&nbsp;Suite&nbsp;330,&nbsp;Boston,&nbsp;MA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;02111-1307&nbsp;&nbsp;USA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;Contact:&nbsp;Maxence.Guesdon@inria.fr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br>
<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br>
</code><table><tr><td></td><td><span class="comment">(*********************************************************************************)</span></td></tr></table><code class="code"><br>
<br>
</code><table><tr><td></td><td><span class="comment">(** *)</span></td></tr></table><code class="code"><br>
<br>
<span class="keyword">open</span>&nbsp;<span class="constructor">Grdf_types</span>;;<br>
<span class="keyword">open</span>&nbsp;<span class="constructor">Rdf_term</span>;;<br>
<span class="keyword">open</span>&nbsp;<span class="constructor">Rdf_graph</span>;;<br>
<br>
<span class="keyword">module</span>&nbsp;<span class="constructor">Iriset</span>&nbsp;=&nbsp;<span class="constructor">Rdf_iri</span>.<span class="constructor">Iriset</span>;;<br>
<br>
<span class="keyword">let</span>&nbsp;dbg&nbsp;=&nbsp;<span class="constructor">Misc</span>.create_log_fun<br>
&nbsp;&nbsp;~prefix:&nbsp;<span class="string">"Grdfs"</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"GENET_GRDFS_DEBUG_LEVEL"</span><br>
;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <h2 id="2_Vocabulary">Vocabulary</h2> *)</span></td></tr></table><code class="code"><br>
<br>
<span class="keyword">let</span>&nbsp;genet&nbsp;=&nbsp;<span class="constructor">Rdf_iri</span>.iri&nbsp;<span class="string">"https://raw.github.com/zoggy/genet/master/doc/genet.ttl"</span>;;<br>
<span class="keyword">let</span>&nbsp;genet_&nbsp;s&nbsp;=&nbsp;<span class="constructor">Rdf_iri</span>.set_fragment&nbsp;genet&nbsp;(<span class="constructor">Some</span>&nbsp;s);;<br>
<br>
<span class="keyword">let</span>&nbsp;rdf_&nbsp;=&nbsp;<span class="constructor">Rdf_rdf</span>.rdf_&nbsp;;;<br>
<span class="keyword">let</span>&nbsp;rdfs_&nbsp;=&nbsp;<span class="constructor">Rdf_rdfs</span>.rdfs_;;<br>
<span class="keyword">let</span>&nbsp;dc_&nbsp;=&nbsp;<span class="constructor">Rdf_iri</span>.concat&nbsp;(<span class="constructor">Rdf_iri</span>.iri&nbsp;<span class="string">"http://purl.org/dc/elements/1.1"</span>);;<br>
<span class="keyword">let</span>&nbsp;owl_&nbsp;s&nbsp;=&nbsp;<span class="constructor">Rdf_iri</span>.set_fragment&nbsp;(<span class="constructor">Rdf_iri</span>.iri&nbsp;<span class="string">"http://www.w3.org/2002/07/owl"</span>)&nbsp;(<span class="constructor">Some</span>&nbsp;s);;<br>
<span class="keyword">let</span>&nbsp;xsd_&nbsp;s&nbsp;=&nbsp;<span class="constructor">Rdf_iri</span>.set_fragment&nbsp;(<span class="constructor">Rdf_iri</span>.iri&nbsp;<span class="string">"http://www.w3.org/2001/XMLSchema"</span>)&nbsp;(<span class="constructor">Some</span>&nbsp;s);;<br>
<span class="keyword">let</span>&nbsp;foaf_&nbsp;=&nbsp;<span class="constructor">Rdf_foaf</span>.foaf_&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;datatype_integer&nbsp;=&nbsp;xsd_<span class="string">"integer"</span>;;<br>
<br>
<span class="keyword">let</span>&nbsp;namespaces&nbsp;=&nbsp;[&nbsp;genet_<span class="string">""</span>,&nbsp;<span class="string">"genet"</span>&nbsp;;&nbsp;rdfs_<span class="string">""</span>,&nbsp;<span class="string">"rdfs"</span>&nbsp;;&nbsp;dc_<span class="string">""</span>,&nbsp;<span class="string">"dc"</span>&nbsp;;&nbsp;xsd_<span class="string">""</span>,&nbsp;<span class="string">"xsd"</span>&nbsp;]<br>
<br>
<span class="keyword">let</span>&nbsp;li_&nbsp;n&nbsp;=<br>
&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;n&nbsp;&lt;=&nbsp;0&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;(<span class="constructor">Invalid_argument</span>&nbsp;(<span class="constructor">Printf</span>.sprintf&nbsp;<span class="string">"li:&nbsp;n=%d&nbsp;&lt;=&nbsp;0"</span>&nbsp;n))<br>
&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;rdf_&nbsp;(<span class="constructor">Printf</span>.sprintf&nbsp;<span class="string">"li%n"</span>&nbsp;n)<br>
;;<br>
<br>
<span class="keyword">let</span>&nbsp;iri_parent&nbsp;iri&nbsp;=<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;path&nbsp;=&nbsp;<span class="constructor">Rdf_iri</span>.path&nbsp;iri&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="comment">(*prerr_endline&nbsp;(Printf.sprintf&nbsp;"iri_parent&nbsp;iri=%s,&nbsp;path=%s"&nbsp;(Rdf_iri.string&nbsp;iri)&nbsp;(String.concat&nbsp;"&nbsp;|&nbsp;"&nbsp;path));*)</span><br>
&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;<span class="constructor">List</span>.rev&nbsp;path&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;iri<br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;::&nbsp;q&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Rdf_iri</span>.set_path&nbsp;iri&nbsp;(<span class="constructor">List</span>.rev&nbsp;q)<br>
;;<br>
<br>
<span class="keyword">let</span>&nbsp;rdf_type&nbsp;=&nbsp;rdf_<span class="string">"type"</span>;;<br>
<br>
<span class="keyword">let</span>&nbsp;genet_element&nbsp;=&nbsp;genet_<span class="string">"Element"</span>;;<br>
<span class="keyword">let</span>&nbsp;genet_tool&nbsp;=&nbsp;genet_&nbsp;<span class="string">"Tool"</span>;;<br>
<span class="keyword">let</span>&nbsp;genet_branch&nbsp;=&nbsp;genet_&nbsp;<span class="string">"Branch"</span>;;<br>
<span class="keyword">let</span>&nbsp;genet_intf&nbsp;=&nbsp;genet_&nbsp;<span class="string">"Interface"</span>;;<br>
<span class="keyword">let</span>&nbsp;genet_version&nbsp;=&nbsp;genet_&nbsp;<span class="string">"Version"</span>;;<br>
<span class="keyword">let</span>&nbsp;genet_filetype&nbsp;=&nbsp;genet_&nbsp;<span class="string">"Filetype"</span>;;<br>
<span class="keyword">let</span>&nbsp;genet_chain&nbsp;=&nbsp;genet_&nbsp;<span class="string">"Chain"</span>;;<br>
<span class="keyword">let</span>&nbsp;genet_flatchain&nbsp;=&nbsp;genet_&nbsp;<span class="string">"Flatchain"</span>;;<br>
<span class="keyword">let</span>&nbsp;genet_flatopn&nbsp;=&nbsp;genet_&nbsp;<span class="string">"Flatopn"</span>;;<br>
<span class="keyword">let</span>&nbsp;genet_port&nbsp;=&nbsp;genet_&nbsp;<span class="string">"Port"</span>;;<br>
<span class="keyword">let</span>&nbsp;genet_instchain&nbsp;=&nbsp;genet_&nbsp;<span class="string">"Instchain"</span>;;<br>
<span class="keyword">let</span>&nbsp;genet_instopn&nbsp;=&nbsp;genet_&nbsp;<span class="string">"InstOperation"</span>;;<br>
<span class="keyword">let</span>&nbsp;genet_implode&nbsp;=&nbsp;genet_<span class="string">"Implode"</span>;;<br>
<span class="keyword">let</span>&nbsp;genet_explode&nbsp;=&nbsp;genet_<span class="string">"Explode"</span>;;<br>
<span class="comment">(*let&nbsp;genet_subgraph&nbsp;=&nbsp;genet_"Subgraph";;*)</span><br>
<span class="keyword">let</span>&nbsp;genet_diffcommand&nbsp;=&nbsp;genet_<span class="string">"DiffCommand"</span>;;<br>
<br>
<span class="keyword">let</span>&nbsp;string_of_class&nbsp;=&nbsp;<span class="keyword">function</span><br>
&nbsp;&nbsp;s&nbsp;<span class="keyword">when</span>&nbsp;<span class="constructor">Rdf_iri</span>.equal&nbsp;s&nbsp;genet_tool&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="string">"tool"</span><br>
<span class="keywordsign">|</span>&nbsp;s&nbsp;<span class="keyword">when</span>&nbsp;<span class="constructor">Rdf_iri</span>.equal&nbsp;s&nbsp;genet_branch&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="string">"branch"</span><br>
<span class="keywordsign">|</span>&nbsp;s&nbsp;<span class="keyword">when</span>&nbsp;<span class="constructor">Rdf_iri</span>.equal&nbsp;s&nbsp;genet_intf&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="string">"interface"</span><br>
<span class="keywordsign">|</span>&nbsp;s&nbsp;<span class="keyword">when</span>&nbsp;<span class="constructor">Rdf_iri</span>.equal&nbsp;s&nbsp;genet_version&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="string">"version"</span><br>
<span class="keywordsign">|</span>&nbsp;s&nbsp;<span class="keyword">when</span>&nbsp;<span class="constructor">Rdf_iri</span>.equal&nbsp;s&nbsp;genet_filetype&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="string">"filetype"</span><br>
<span class="keywordsign">|</span>&nbsp;s&nbsp;<span class="keyword">when</span>&nbsp;<span class="constructor">Rdf_iri</span>.equal&nbsp;s&nbsp;genet_chain&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="string">"chain"</span><br>
<span class="keywordsign">|</span>&nbsp;s&nbsp;<span class="keyword">when</span>&nbsp;<span class="constructor">Rdf_iri</span>.equal&nbsp;s&nbsp;genet_flatchain&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="string">"flatchain"</span><br>
<span class="keywordsign">|</span>&nbsp;s&nbsp;<span class="keyword">when</span>&nbsp;<span class="constructor">Rdf_iri</span>.equal&nbsp;s&nbsp;genet_instchain&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="string">"instchain"</span><br>
<span class="keywordsign">|</span>&nbsp;s&nbsp;<span class="keyword">when</span>&nbsp;<span class="constructor">Rdf_iri</span>.equal&nbsp;s&nbsp;genet_instopn&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="string">"instopn"</span><br>
<span class="keywordsign">|</span>&nbsp;s&nbsp;<span class="keyword">when</span>&nbsp;<span class="constructor">Rdf_iri</span>.equal&nbsp;s&nbsp;genet_flatopn&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="string">"flatopn"</span><br>
<span class="keywordsign">|</span>&nbsp;s&nbsp;<span class="keyword">when</span>&nbsp;<span class="constructor">Rdf_iri</span>.equal&nbsp;s&nbsp;genet_diffcommand&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="string">"diffcommand"</span><br>
<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="string">""</span><br>
;;<br>
<br>
<span class="keyword">let</span>&nbsp;genet_name&nbsp;=&nbsp;genet_<span class="string">"name"</span>;;<br>
<span class="keyword">let</span>&nbsp;genet_desc&nbsp;=&nbsp;dc_<span class="string">"description"</span>;;<br>
<span class="keyword">let</span>&nbsp;genet_file_ext&nbsp;=&nbsp;genet_<span class="string">"file-extension"</span>;;<br>
<span class="keyword">let</span>&nbsp;genet_hasbranch&nbsp;=&nbsp;genet_<span class="string">"hasBranch"</span>;;<br>
<span class="keyword">let</span>&nbsp;genet_nointf&nbsp;=&nbsp;genet_<span class="string">"noInterface"</span>;;<br>
<span class="keyword">let</span>&nbsp;genet_haspath&nbsp;=&nbsp;genet_<span class="string">"hasPath"</span>;;<br>
<span class="keyword">let</span>&nbsp;genet_usetool&nbsp;=&nbsp;genet_<span class="string">"useTool"</span>;;<br>
<span class="keyword">let</span>&nbsp;genet_hasversion&nbsp;=&nbsp;genet_<span class="string">"hasVersion"</span>;;<br>
<span class="keyword">let</span>&nbsp;genet_consumes&nbsp;=&nbsp;genet_<span class="string">"consumes"</span>;;<br>
<span class="keyword">let</span>&nbsp;genet_produces&nbsp;=&nbsp;genet_<span class="string">"produces"</span>;;<br>
<span class="keyword">let</span>&nbsp;genet_hasdiffcom&nbsp;=&nbsp;genet_<span class="string">"hasDiffCommand"</span>;;<br>
<span class="keyword">let</span>&nbsp;genet_hasintf&nbsp;=&nbsp;genet_<span class="string">"hasInterface"</span>;;<br>
<span class="keyword">let</span>&nbsp;genet_hastype&nbsp;=&nbsp;genet_<span class="string">"hasFiletype"</span>;;<br>
<span class="comment">(*let&nbsp;genet_versionid&nbsp;=&nbsp;genet_"versionId";;*)</span><br>
<span class="keyword">let</span>&nbsp;genet_flattenedto&nbsp;=&nbsp;genet_<span class="string">"flattenedTo"</span>;;<br>
<span class="keyword">let</span>&nbsp;genet_opfrom&nbsp;=&nbsp;genet_<span class="string">"operationFrom"</span>;;<br>
<span class="keyword">let</span>&nbsp;genet_portfrom&nbsp;=&nbsp;genet_<span class="string">"portFrom"</span>;;<br>
<span class="keyword">let</span>&nbsp;genet_containsop&nbsp;=&nbsp;genet_<span class="string">"containsOperation"</span>;;<br>
<span class="keyword">let</span>&nbsp;genet_createdon&nbsp;=&nbsp;genet_<span class="string">"createdOn"</span>;;<br>
<span class="keyword">let</span>&nbsp;genet_startedon&nbsp;=&nbsp;genet_<span class="string">"startedOn"</span>;;<br>
<span class="keyword">let</span>&nbsp;genet_stoppedon&nbsp;=&nbsp;genet_<span class="string">"stoppedOn"</span>;;<br>
<span class="keyword">let</span>&nbsp;genet_isactive&nbsp;=&nbsp;genet_<span class="string">"isActive"</span>;;<br>
<span class="keyword">let</span>&nbsp;genet_instanciate&nbsp;=&nbsp;genet_<span class="string">"instanciate"</span>;;<br>
<span class="comment">(*let&nbsp;genet_hascommitid&nbsp;=&nbsp;genet_"hasCommitId";;*)</span><br>
<span class="keyword">let</span>&nbsp;genet_useinput&nbsp;=&nbsp;genet_<span class="string">"useInput"</span>;;<br>
<span class="keyword">let</span>&nbsp;genet_useinputcommitid&nbsp;=&nbsp;genet_<span class="string">"useInputCommitId"</span>;;<br>
<span class="keyword">let</span>&nbsp;genet_useversion&nbsp;=&nbsp;genet_<span class="string">"useVersion"</span>;;<br>
<span class="keyword">let</span>&nbsp;genet_usetoolversion&nbsp;=&nbsp;genet_<span class="string">"useToolVersion"</span>;;<br>
<span class="keyword">let</span>&nbsp;genet_filemd5&nbsp;=&nbsp;genet_<span class="string">"fileMd5"</span>;;<br>
<span class="keyword">let</span>&nbsp;genet_hasimplode&nbsp;=&nbsp;genet_<span class="string">"hasImplode"</span>;;<br>
<span class="keyword">let</span>&nbsp;genet_returncode&nbsp;=&nbsp;genet_<span class="string">"returnCode"</span>;;<br>
<span class="keyword">let</span>&nbsp;genet_commandoutput&nbsp;=&nbsp;genet_<span class="string">"commandOutput"</span>;;<br>
<span class="keyword">let</span>&nbsp;genet_failedcommand&nbsp;=&nbsp;genet_<span class="string">"failedCommand"</span>;;<br>
<span class="keyword">let</span>&nbsp;genet_refinstfor&nbsp;=&nbsp;genet_<span class="string">"referenceInstFor"</span>;;<br>
<br>
<span class="keyword">let</span>&nbsp;add_triple&nbsp;wld&nbsp;~sub&nbsp;~pred&nbsp;~obj&nbsp;=<br>
&nbsp;&nbsp;wld.wld_graph.add_triple&nbsp;~sub&nbsp;~pred&nbsp;~obj<br>
;;<br>
<br>
<span class="keyword">let</span>&nbsp;rem_triple&nbsp;wld&nbsp;~sub&nbsp;~pred&nbsp;~obj&nbsp;=<br>
&nbsp;&nbsp;wld.wld_graph.rem_triple&nbsp;~sub&nbsp;~pred&nbsp;~obj<br>
;;<br>
<br>
<span class="keyword">let</span>&nbsp;add_type&nbsp;wld&nbsp;~sub&nbsp;~obj&nbsp;=<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;pred&nbsp;=&nbsp;rdf_type&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;add_triple&nbsp;wld&nbsp;~sub:&nbsp;(<span class="constructor">Rdf_term</span>.<span class="constructor">Iri</span>&nbsp;sub)&nbsp;~pred&nbsp;~obj:&nbsp;(<span class="constructor">Rdf_term</span>.<span class="constructor">Iri</span>&nbsp;obj)<br>
;;<br>
<br>
<span class="keyword">let</span>&nbsp;add_triple_iris&nbsp;wld&nbsp;~sub&nbsp;~pred&nbsp;~obj&nbsp;=<br>
&nbsp;&nbsp;add_triple&nbsp;wld&nbsp;~sub:&nbsp;(<span class="constructor">Iri</span>&nbsp;sub)&nbsp;~pred&nbsp;~obj:&nbsp;(<span class="constructor">Iri</span>&nbsp;obj)<br>
;;<br>
<br>
<span class="keyword">let</span>&nbsp;rem_triple_iris&nbsp;wld&nbsp;~sub&nbsp;~pred&nbsp;~obj&nbsp;=<br>
&nbsp;&nbsp;rem_triple&nbsp;wld&nbsp;~sub:&nbsp;(<span class="constructor">Iri</span>&nbsp;sub)&nbsp;~pred&nbsp;~obj:&nbsp;(<span class="constructor">Iri</span>&nbsp;obj)<br>
;;<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <h2 id="2_Irisofmanipulatedelements">Iris of manipulated elements</h2> *)</span></td></tr></table><code class="code"><br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <h3 id="3_Tools">Tools</h3> *)</span></td></tr></table><code class="code"><br>
<br>
<span class="keyword">let</span>&nbsp;suffix_tools&nbsp;=&nbsp;<span class="string">"tools"</span>;;<br>
<span class="keyword">let</span>&nbsp;iri_tools&nbsp;prefix&nbsp;=&nbsp;<span class="constructor">Rdf_iri</span>.concat&nbsp;prefix&nbsp;suffix_tools;;<br>
<span class="keyword">let</span>&nbsp;iri_tool&nbsp;~prefix&nbsp;~tool&nbsp;=<br>
&nbsp;&nbsp;<span class="constructor">Rdf_iri</span>.concat&nbsp;(iri_tools&nbsp;prefix)&nbsp;tool;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <h3 id="3_Chains">Chains</h3> *)</span></td></tr></table><code class="code"><br>
<br>
<span class="keyword">let</span>&nbsp;suffix_chains&nbsp;=&nbsp;<span class="string">"chains"</span>;;<br>
<span class="keyword">let</span>&nbsp;iri_chains&nbsp;prefix&nbsp;=&nbsp;<span class="constructor">Rdf_iri</span>.concat&nbsp;prefix&nbsp;suffix_chains;;<br>
<br>
<span class="keyword">let</span>&nbsp;concat_chain_name&nbsp;modname&nbsp;name&nbsp;=&nbsp;<span class="constructor">Printf</span>.sprintf&nbsp;<span class="string">"%s.%s"</span>&nbsp;modname&nbsp;name;;<br>
<span class="keyword">let</span>&nbsp;split_chain_name&nbsp;s&nbsp;=<br>
&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;<span class="constructor">List</span>.rev&nbsp;(<span class="constructor">Misc</span>.split_string&nbsp;s&nbsp;[<span class="string">'/'</span>])&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;failwith&nbsp;(<span class="string">"Invalid&nbsp;name&nbsp;"</span>^s)<br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;name&nbsp;::&nbsp;rest&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="constructor">Misc</span>.is_capitalized&nbsp;name&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">`</span><span class="constructor">Modname</span>&nbsp;s<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;rest&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">Chainname</span>&nbsp;name<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">Fullname</span>&nbsp;(<span class="constructor">String</span>.concat&nbsp;<span class="string">"/"</span>&nbsp;(<span class="constructor">List</span>.rev&nbsp;rest),&nbsp;name)<br>
;;<br>
<br>
<span class="keyword">let</span>&nbsp;iri_chain_module&nbsp;~prefix&nbsp;modname&nbsp;=<br>
&nbsp;&nbsp;<span class="constructor">Rdf_iri</span>.concat&nbsp;(iri_chains&nbsp;prefix)&nbsp;modname;;<br>
<br>
<span class="keyword">let</span>&nbsp;iri_chain&nbsp;~prefix&nbsp;~modname&nbsp;name&nbsp;&nbsp;=<br>
&nbsp;&nbsp;<span class="constructor">Rdf_iri</span>.concat&nbsp;(iri_chain_module&nbsp;~prefix&nbsp;modname)&nbsp;name<br>
;;<br>
<br>
<span class="keyword">let</span>&nbsp;is_in_&nbsp;f_prefix&nbsp;prefix&nbsp;iri&nbsp;=<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;iri&nbsp;=&nbsp;<span class="constructor">Rdf_iri</span>.string&nbsp;iri&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;prefix&nbsp;=&nbsp;<span class="constructor">Rdf_iri</span>.string&nbsp;(f_prefix&nbsp;prefix)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="constructor">Misc</span>.is_prefix&nbsp;prefix&nbsp;iri&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;len&nbsp;=&nbsp;<span class="constructor">String</span>.length&nbsp;prefix&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;base&nbsp;=&nbsp;<span class="constructor">String</span>.sub&nbsp;iri&nbsp;len&nbsp;(<span class="constructor">String</span>.length&nbsp;iri&nbsp;-&nbsp;len)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Some</span>&nbsp;base<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">None</span><br>
;;<br>
<br>
<span class="keyword">let</span>&nbsp;is_in_chains&nbsp;=&nbsp;is_in_&nbsp;iri_chains;;<br>
<br>
<span class="keyword">let</span>&nbsp;is_iri_chain_module&nbsp;prefix&nbsp;iri&nbsp;=<br>
&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;is_in_chains&nbsp;prefix&nbsp;iri&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">None</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">None</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Some</span>&nbsp;base&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;split_chain_name&nbsp;base&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">`</span><span class="constructor">Modname</span>&nbsp;modname&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Some</span>&nbsp;modname<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">None</span><br>
;;<br>
<br>
<span class="keyword">let</span>&nbsp;is_iri_chain&nbsp;prefix&nbsp;iri&nbsp;=<br>
&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;is_in_chains&nbsp;prefix&nbsp;iri&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">None</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">None</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Some</span>&nbsp;base&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;split_chain_name&nbsp;base&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">`</span><span class="constructor">Fullname</span>&nbsp;fullname&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Some</span>&nbsp;fullname<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">None</span><br>
;;<br>
<br>
<span class="keyword">let</span>&nbsp;chain_module_of_iri&nbsp;prefix&nbsp;iri&nbsp;=<br>
&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;is_iri_chain_module&nbsp;prefix&nbsp;iri&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Some</span>&nbsp;modname&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;modname<br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">None</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;failwith&nbsp;(<span class="constructor">Printf</span>.sprintf&nbsp;<span class="string">"%s&nbsp;is&nbsp;not&nbsp;a&nbsp;chain&nbsp;module&nbsp;iri"</span>&nbsp;(<span class="constructor">Rdf_iri</span>.string&nbsp;iri))<br>
;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <h3 id="3_Flatchains">Flat chains</h3> *)</span></td></tr></table><code class="code"><br>
<br>
<span class="keyword">let</span>&nbsp;suffix_fchains&nbsp;=&nbsp;<span class="string">"flat-chains"</span>;;<br>
<span class="keyword">let</span>&nbsp;iri_fchains&nbsp;prefix&nbsp;=&nbsp;<span class="constructor">Rdf_iri</span>.concat&nbsp;prefix&nbsp;suffix_fchains;;<br>
<br>
<span class="keyword">let</span>&nbsp;iri_fchain_module&nbsp;~prefix&nbsp;modname&nbsp;=<br>
&nbsp;&nbsp;<span class="constructor">Rdf_iri</span>.concat&nbsp;(iri_fchains&nbsp;prefix)&nbsp;modname;;<br>
<br>
<span class="keyword">let</span>&nbsp;split_fchain_name&nbsp;s&nbsp;=<br>
&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;<span class="constructor">Misc</span>.split_string&nbsp;s&nbsp;[<span class="string">'/'</span>]&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;failwith&nbsp;(<span class="string">"Invalid&nbsp;name&nbsp;"</span>^s)<br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;l&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;<span class="keyword">rec</span>&nbsp;iter&nbsp;acc&nbsp;=&nbsp;<span class="keyword">function</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(<span class="constructor">List</span>.rev&nbsp;acc,&nbsp;[])<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;s&nbsp;::&nbsp;q&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="constructor">Misc</span>.is_capitalized&nbsp;s&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iter&nbsp;(s&nbsp;::&nbsp;acc)&nbsp;q<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="constructor">List</span>.rev&nbsp;acc,&nbsp;s&nbsp;::&nbsp;q)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;(modname,&nbsp;rest)&nbsp;=&nbsp;iter&nbsp;[]&nbsp;l&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;rest&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">Modname</span>&nbsp;s<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;[name]&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">Fullname</span>&nbsp;((modname,&nbsp;name),&nbsp;<span class="string">""</span>)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;[name&nbsp;;&nbsp;id]&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">Fullname</span>&nbsp;((modname,&nbsp;name),&nbsp;id)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;name&nbsp;::&nbsp;id&nbsp;::&nbsp;path&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">`</span><span class="constructor">Fchain_op</span>&nbsp;((modname,&nbsp;name),&nbsp;id,&nbsp;path)<br>
;;<br>
<span class="keyword">let</span>&nbsp;iri_fchain&nbsp;~prefix&nbsp;~modname&nbsp;?id&nbsp;~name&nbsp;&nbsp;=<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;iri&nbsp;=&nbsp;<span class="constructor">Rdf_iri</span>.concat&nbsp;(iri_fchain_module&nbsp;~prefix&nbsp;modname)&nbsp;name&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;id&nbsp;<span class="keyword">with</span>&nbsp;<span class="constructor">None</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;iri&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Some</span>&nbsp;id&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Rdf_iri</span>.concat&nbsp;iri&nbsp;id<br>
;;<br>
<br>
<span class="keyword">let</span>&nbsp;&nbsp;iri_fchain_op&nbsp;fchain&nbsp;path&nbsp;=<br>
&nbsp;&nbsp;<span class="constructor">List</span>.fold_left&nbsp;<span class="constructor">Rdf_iri</span>.concat&nbsp;fchain&nbsp;path<br>
;;<br>
<br>
<span class="keyword">let</span>&nbsp;is_in_fchains&nbsp;=&nbsp;is_in_&nbsp;iri_fchains;;<br>
<br>
<span class="keyword">let</span>&nbsp;is_iri_fchain_module&nbsp;prefix&nbsp;iri&nbsp;=<br>
&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;is_in_fchains&nbsp;prefix&nbsp;iri&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">None</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">None</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Some</span>&nbsp;base&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;split_fchain_name&nbsp;base&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">`</span><span class="constructor">Modname</span>&nbsp;modname&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Some</span>&nbsp;modname<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">None</span><br>
;;<br>
<br>
<span class="keyword">let</span>&nbsp;is_iri_fchain&nbsp;prefix&nbsp;iri&nbsp;=<br>
&nbsp;&nbsp;<span class="comment">(*prerr_endline&nbsp;(Printf.sprintf&nbsp;"is_iri_fchain&nbsp;%S"&nbsp;(Rdf_iri.string&nbsp;iri));*)</span><br>
&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;is_in_fchains&nbsp;prefix&nbsp;iri&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">None</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">None</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Some</span>&nbsp;base&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*prerr_endline&nbsp;(Printf.sprintf&nbsp;"base=%s"&nbsp;base);*)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;split_fchain_name&nbsp;base&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">`</span><span class="constructor">Fullname</span>&nbsp;(fullname,&nbsp;id)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Some</span>&nbsp;(fullname,&nbsp;id)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">None</span><br>
;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <h3 id="3_Instanciatedchains">Instanciated chains</h3> *)</span></td></tr></table><code class="code"><br>
<br>
<span class="keyword">let</span>&nbsp;suffix_ichains&nbsp;=&nbsp;<span class="string">"inst-chains"</span>;;<br>
<span class="keyword">let</span>&nbsp;suffix_producers_of&nbsp;=&nbsp;<span class="string">"producers-of"</span>;;<br>
<span class="keyword">let</span>&nbsp;suffix_consumers_of&nbsp;=&nbsp;<span class="string">"consumers-of"</span>;;<br>
<br>
<span class="keyword">let</span>&nbsp;iri_ichains&nbsp;prefix&nbsp;=&nbsp;<span class="constructor">Rdf_iri</span>.concat&nbsp;prefix&nbsp;suffix_ichains;;<br>
<br>
<span class="keyword">let</span>&nbsp;iri_ichain_module&nbsp;~prefix&nbsp;modname&nbsp;=<br>
&nbsp;&nbsp;<span class="constructor">Rdf_iri</span>.concat&nbsp;(iri_ichains&nbsp;prefix)&nbsp;modname;;<br>
<br>
<span class="keyword">let</span>&nbsp;iri_ichain&nbsp;~prefix&nbsp;~modname&nbsp;~name&nbsp;~id&nbsp;&nbsp;=<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;iri&nbsp;=&nbsp;<span class="constructor">Rdf_iri</span>.concat&nbsp;(iri_ichain_module&nbsp;~prefix&nbsp;modname)&nbsp;name&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="constructor">Rdf_iri</span>.concat&nbsp;iri&nbsp;id<br>
;;<br>
<br>
<span class="keyword">let</span>&nbsp;iri_ichain_file&nbsp;inst_iri&nbsp;file&nbsp;=<br>
&nbsp;&nbsp;<span class="constructor">List</span>.fold_left&nbsp;<span class="constructor">Rdf_iri</span>.concat&nbsp;inst_iri&nbsp;[&nbsp;<span class="string">"files"</span>&nbsp;;&nbsp;file&nbsp;]<br>
;;<br>
<br>
<span class="keyword">let</span>&nbsp;ichain_in_file_rank&nbsp;iri&nbsp;=<br>
&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;<span class="constructor">List</span>.rev&nbsp;(<span class="constructor">Rdf_iri</span>.path&nbsp;iri)&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;failwith&nbsp;<span class="string">"inchain_in_file:&nbsp;empty&nbsp;iri"</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;n&nbsp;::&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">try</span>&nbsp;int_of_string&nbsp;n<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;msg&nbsp;=&nbsp;<span class="constructor">Printf</span>.sprintf&nbsp;<span class="string">"Bad&nbsp;in_file&nbsp;iri:&nbsp;%s"</span>&nbsp;(<span class="constructor">Rdf_iri</span>.string&nbsp;iri)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;failwith&nbsp;msg<br>
;;<br>
<br>
<span class="keyword">let</span>&nbsp;iri_ichain_in_file&nbsp;iri&nbsp;rank&nbsp;=<br>
&nbsp;&nbsp;<span class="constructor">Rdf_iri</span>.concat&nbsp;(<span class="constructor">Rdf_iri</span>.concat&nbsp;iri&nbsp;<span class="string">"input"</span>)&nbsp;(string_of_int&nbsp;rank)<br>
;;<br>
<br>
<span class="keyword">let</span>&nbsp;is_in_ichains&nbsp;=&nbsp;is_in_&nbsp;iri_ichains;;<br>
<br>
<span class="keyword">let</span>&nbsp;is_iri_ichain&nbsp;prefix&nbsp;iri&nbsp;=<br>
&nbsp;&nbsp;<span class="comment">(*prerr_endline&nbsp;(Printf.sprintf&nbsp;"is_iri_fchain&nbsp;%S"&nbsp;(Rdf_iri.string&nbsp;iri));*)</span><br>
&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;is_in_ichains&nbsp;prefix&nbsp;iri&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">None</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">None</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Some</span>&nbsp;base&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*prerr_endline&nbsp;(Printf.sprintf&nbsp;"base=%s"&nbsp;base);*)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;split_fchain_name&nbsp;base&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">`</span><span class="constructor">Fullname</span>&nbsp;(fullname,&nbsp;id)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Some</span>&nbsp;(fullname,&nbsp;id)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">None</span><br>
;;<br>
<br>
<span class="keyword">let</span>&nbsp;iri_ichains_producers_of&nbsp;prefix&nbsp;path&nbsp;=<br>
&nbsp;&nbsp;<span class="constructor">List</span>.fold_left&nbsp;<span class="constructor">Rdf_iri</span>.concat&nbsp;prefix<br>
&nbsp;&nbsp;(suffix_ichains&nbsp;::&nbsp;suffix_producers_of&nbsp;::&nbsp;path)<br>
;;<br>
<br>
<span class="keyword">let</span>&nbsp;iri_ichains_consumers_of&nbsp;prefix&nbsp;path&nbsp;=<br>
&nbsp;&nbsp;<span class="constructor">List</span>.fold_left&nbsp;<span class="constructor">Rdf_iri</span>.concat&nbsp;prefix<br>
&nbsp;&nbsp;(suffix_ichains&nbsp;::&nbsp;suffix_consumers_of&nbsp;::&nbsp;path)<br>
;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <h3 id="3_Versions">Versions</h3> *)</span></td></tr></table><code class="code"><br>
<br>
<span class="keyword">let</span>&nbsp;suffix_versions&nbsp;=&nbsp;<span class="string">"versions"</span>;;<br>
<span class="keyword">let</span>&nbsp;iri_versions&nbsp;prefix&nbsp;=&nbsp;<span class="constructor">Rdf_iri</span>.concat&nbsp;prefix&nbsp;suffix_versions;;<br>
<span class="keyword">let</span>&nbsp;iri_version&nbsp;~tool&nbsp;~version&nbsp;=<br>
&nbsp;&nbsp;<span class="constructor">Rdf_iri</span>.concat&nbsp;(iri_versions&nbsp;tool)&nbsp;version;;<br>
<span class="keyword">let</span>&nbsp;iri_tool_of_version&nbsp;iri&nbsp;=&nbsp;iri_parent&nbsp;(iri_parent&nbsp;iri);;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <h3 id="3_Diffcommands">Diff commands</h3> *)</span></td></tr></table><code class="code"><br>
<br>
<span class="keyword">let</span>&nbsp;suffix_diffcommands&nbsp;=&nbsp;<span class="string">"diff-commands"</span><br>
<span class="keyword">let</span>&nbsp;iri_diffcommands&nbsp;~prefix&nbsp;=&nbsp;<span class="constructor">Rdf_iri</span>.concat&nbsp;prefix&nbsp;suffix_diffcommands<br>
<span class="keyword">let</span>&nbsp;iri_diffcommand&nbsp;~prefix&nbsp;~name&nbsp;=&nbsp;<span class="constructor">Rdf_iri</span>.concat&nbsp;(iri_diffcommands&nbsp;~prefix)&nbsp;name<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <h3 id="3_Interfaces">Interfaces</h3> *)</span></td></tr></table><code class="code"><br>
<br>
<span class="keyword">let</span>&nbsp;suffix_intfs&nbsp;=&nbsp;<span class="string">"interfaces"</span><br>
<span class="keyword">let</span>&nbsp;iri_intfs&nbsp;~tool&nbsp;=&nbsp;<span class="constructor">Rdf_iri</span>.concat&nbsp;tool&nbsp;suffix_intfs;;<br>
<span class="keyword">let</span>&nbsp;iri_intf&nbsp;~tool&nbsp;~intf&nbsp;=&nbsp;<span class="constructor">Rdf_iri</span>.concat&nbsp;(iri_intfs&nbsp;tool)&nbsp;intf;;<br>
<span class="keyword">let</span>&nbsp;iri_tool_of_intf&nbsp;iri&nbsp;=&nbsp;iri_parent&nbsp;(iri_parent&nbsp;iri);;<br>
<span class="keyword">let</span>&nbsp;iri_intf_in&nbsp;intf&nbsp;=&nbsp;<span class="constructor">Rdf_iri</span>.concat&nbsp;intf&nbsp;<span class="string">"in"</span>;;<br>
<span class="keyword">let</span>&nbsp;iri_intf_out&nbsp;intf&nbsp;=&nbsp;<span class="constructor">Rdf_iri</span>.concat&nbsp;intf&nbsp;<span class="string">"out"</span>;;<br>
<span class="keyword">let</span>&nbsp;iri_intf_in_port&nbsp;intf&nbsp;n&nbsp;=<br>
&nbsp;&nbsp;<span class="constructor">Rdf_iri</span>.concat&nbsp;(iri_intf_in&nbsp;intf)&nbsp;(string_of_int&nbsp;n)<br>
<span class="keyword">let</span>&nbsp;iri_intf_out_port&nbsp;intf&nbsp;n&nbsp;=<br>
&nbsp;&nbsp;<span class="constructor">Rdf_iri</span>.concat&nbsp;(iri_intf_out&nbsp;intf)&nbsp;(string_of_int&nbsp;n)<br>
<span class="keyword">let</span>&nbsp;port_rank&nbsp;iri&nbsp;=<br>
&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;<span class="constructor">List</span>.rev&nbsp;(<span class="constructor">Rdf_iri</span>.path&nbsp;iri)&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;failwith&nbsp;(<span class="string">"Invalid&nbsp;port&nbsp;iri:&nbsp;"</span>^(<span class="constructor">Rdf_iri</span>.string&nbsp;iri))<br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;n&nbsp;::&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">try</span>&nbsp;int_of_string&nbsp;n<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;failwith&nbsp;(<span class="string">"Invalid&nbsp;port&nbsp;number&nbsp;in&nbsp;iri:&nbsp;"</span>^(<span class="constructor">Rdf_iri</span>.string&nbsp;iri))<br>
;;<br>
<span class="keyword">let</span>&nbsp;port_dir_string&nbsp;iri&nbsp;=<br>
&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;<span class="constructor">List</span>.rev&nbsp;(<span class="constructor">Rdf_iri</span>.path&nbsp;(iri_parent&nbsp;iri))&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;failwith&nbsp;(<span class="string">"Bad&nbsp;port&nbsp;iri;&nbsp;"</span>^(<span class="constructor">Rdf_iri</span>.string&nbsp;iri))<br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;s&nbsp;::&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;s<br>
;;<br>
<span class="keyword">let</span>&nbsp;is_a_port&nbsp;iri&nbsp;=<br>
&nbsp;&nbsp;<span class="keyword">try</span>&nbsp;ignore(port_rank&nbsp;iri)&nbsp;;&nbsp;ignore(port_dir_string&nbsp;iri)&nbsp;;&nbsp;<span class="keyword">true</span><br>
&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">false</span><br>
;;<br>
<span class="keyword">let</span>&nbsp;port_container&nbsp;iri&nbsp;=<br>
&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;not&nbsp;(is_a_port&nbsp;iri)&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;failwith&nbsp;(<span class="constructor">Printf</span>.sprintf&nbsp;<span class="string">"%s&nbsp;is&nbsp;not&nbsp;a&nbsp;port"</span>&nbsp;(<span class="constructor">Rdf_iri</span>.string&nbsp;iri));<br>
&nbsp;&nbsp;iri_parent&nbsp;(iri_parent&nbsp;iri)<br>
;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <h3 id="3_Filetypes">Filetypes</h3> *)</span></td></tr></table><code class="code"><br>
<br>
<span class="keyword">let</span>&nbsp;suffix_filetypes&nbsp;=&nbsp;<span class="string">"filetypes"</span>&nbsp;;;<br>
<span class="keyword">let</span>&nbsp;iri_filetypes&nbsp;prefix&nbsp;=&nbsp;<span class="constructor">Rdf_iri</span>.concat&nbsp;prefix&nbsp;suffix_filetypes;;<br>
<span class="keyword">let</span>&nbsp;iri_filetype&nbsp;~prefix&nbsp;name&nbsp;=<br>
&nbsp;&nbsp;<span class="constructor">Rdf_iri</span>.concat&nbsp;(iri_filetypes&nbsp;prefix)&nbsp;name;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <h3 id="3_Branches">Branches</h3> *)</span></td></tr></table><code class="code"><br>
<br>
<span class="keyword">let</span>&nbsp;suffix_branches&nbsp;=&nbsp;<span class="string">"branches"</span>;;<br>
<span class="keyword">let</span>&nbsp;iri_branches&nbsp;parent&nbsp;=&nbsp;<span class="constructor">Rdf_iri</span>.concat&nbsp;parent&nbsp;suffix_branches;;<br>
<span class="keyword">let</span>&nbsp;iri_branch_from_parent_branch&nbsp;parent&nbsp;name&nbsp;=&nbsp;<span class="constructor">Rdf_iri</span>.concat&nbsp;parent&nbsp;name;;<br>
<span class="keyword">let</span>&nbsp;iri_branch_from_parent_tool&nbsp;parent&nbsp;name&nbsp;=<br>
&nbsp;&nbsp;<span class="constructor">Rdf_iri</span>.concat&nbsp;(<span class="constructor">Rdf_iri</span>.concat&nbsp;parent&nbsp;suffix_branches)&nbsp;name;;<br>
<br>
<span class="keyword">let</span>&nbsp;remove_prefix&nbsp;prefix&nbsp;iri&nbsp;=<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;prefix&nbsp;=&nbsp;<span class="constructor">Rdf_iri</span>.string&nbsp;prefix&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;iri&nbsp;=&nbsp;<span class="constructor">Rdf_iri</span>.string&nbsp;iri&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="constructor">Misc</span>.is_prefix&nbsp;prefix&nbsp;iri&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;len_iri&nbsp;=&nbsp;<span class="constructor">String</span>.length&nbsp;iri&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;len_prefix&nbsp;=&nbsp;<span class="constructor">String</span>.length&nbsp;prefix&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;len_prefix&nbsp;=<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;len_prefix&nbsp;&gt;&nbsp;0&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;prefix.[len_prefix&nbsp;-&nbsp;1]&nbsp;=&nbsp;<span class="string">'/'</span>&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;len_prefix&nbsp;-&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;len_prefix<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">String</span>.sub&nbsp;iri&nbsp;len_prefix&nbsp;(len_iri&nbsp;-&nbsp;len_prefix)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;iri<br>
;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <h3 id="3_Diffs">Diffs</h3> *)</span></td></tr></table><code class="code"><br>
<br>
<span class="keyword">let</span>&nbsp;suffix_diff&nbsp;=&nbsp;<span class="string">"diff"</span>;;<br>
<br>
<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** Files and directories *)</span></td></tr></table><code class="code"><br>
<br>
<span class="keyword">let</span>&nbsp;suffix_out&nbsp;=&nbsp;<span class="string">"out"</span>;;<br>
<span class="keyword">let</span>&nbsp;suffix_in&nbsp;=&nbsp;<span class="string">"in"</span>;;<br>
<span class="keyword">let</span>&nbsp;suffix_raw&nbsp;=&nbsp;<span class="string">"raw"</span>;;<br>
<span class="keyword">let</span>&nbsp;iri_outfile_path&nbsp;?(raw=<span class="keyword">false</span>)&nbsp;prefix&nbsp;path&nbsp;=<br>
&nbsp;&nbsp;<span class="constructor">List</span>.fold_left&nbsp;<span class="constructor">Rdf_iri</span>.concat&nbsp;prefix<br>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="keyword">if</span>&nbsp;raw&nbsp;<span class="keyword">then</span>&nbsp;suffix_out&nbsp;::&nbsp;suffix_raw&nbsp;::&nbsp;path&nbsp;<span class="keyword">else</span>&nbsp;suffix_out&nbsp;::&nbsp;path)<br>
;;<br>
<br>
<span class="keyword">let</span>&nbsp;iri_input_path&nbsp;?(raw=<span class="keyword">false</span>)&nbsp;prefix&nbsp;path&nbsp;=<br>
&nbsp;&nbsp;<span class="constructor">List</span>.fold_left&nbsp;<span class="constructor">Rdf_iri</span>.concat&nbsp;prefix<br>
&nbsp;&nbsp;(<span class="keyword">if</span>&nbsp;raw&nbsp;<span class="keyword">then</span>&nbsp;suffix_in&nbsp;::&nbsp;suffix_raw&nbsp;::&nbsp;path&nbsp;<span class="keyword">else</span>&nbsp;suffix_in&nbsp;::&nbsp;path)<br>
;;<br>
<br>
<span class="keyword">let</span>&nbsp;iri_input_file_path&nbsp;?(raw=<span class="keyword">false</span>)&nbsp;prefix&nbsp;path&nbsp;file_path&nbsp;=<br>
&nbsp;&nbsp;<span class="constructor">List</span>.fold_left&nbsp;<span class="constructor">Rdf_iri</span>.concat&nbsp;prefix<br>
&nbsp;&nbsp;((<span class="keyword">if</span>&nbsp;raw&nbsp;<span class="keyword">then</span>&nbsp;suffix_in&nbsp;::&nbsp;suffix_raw&nbsp;::&nbsp;path&nbsp;<span class="keyword">else</span>&nbsp;suffix_in&nbsp;::&nbsp;path)&nbsp;@&nbsp;file_path)<br>
;;<br>
<br>
</code><table><tr><td></td><td><span class="comment">(** <h2 id="2_Utilities">Utilities</h2> *)</span></td></tr></table><code class="code"><br>
<br>
<span class="keyword">let</span>&nbsp;iriset_of_list&nbsp;=&nbsp;<span class="constructor">List</span>.fold_left&nbsp;(<span class="keyword">fun</span>&nbsp;set&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Iriset</span>.add&nbsp;x&nbsp;set)&nbsp;<span class="constructor">Iriset</span>.empty&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;iri_basename&nbsp;iri&nbsp;=<br>
&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;<span class="constructor">List</span>.rev&nbsp;(<span class="constructor">Rdf_iri</span>.path&nbsp;iri)&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="string">""</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;s&nbsp;::&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;s<br>
;;<br>
<br>
<span class="keyword">let</span>&nbsp;is_a&nbsp;wld&nbsp;~sub&nbsp;~obj&nbsp;=<br>
&nbsp;&nbsp;dbg&nbsp;~level:&nbsp;1&nbsp;(<span class="keyword">fun</span>&nbsp;()&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="string">"Grdfs.is_a"</span>);<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;pred&nbsp;=&nbsp;rdf_type&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;dbg&nbsp;~level:&nbsp;2&nbsp;(<span class="keyword">fun</span>&nbsp;()&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="string">"contains_statement&nbsp;?"</span>);<br>
&nbsp;&nbsp;wld.wld_graph.exists_t&nbsp;(sub,&nbsp;pred,&nbsp;obj)<br>
;;<br>
<br>
<span class="keyword">let</span>&nbsp;is_a_&nbsp;iri&nbsp;=<br>
&nbsp;&nbsp;<span class="keyword">fun</span>&nbsp;wld&nbsp;sub&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;dbg&nbsp;~level:&nbsp;1&nbsp;(<span class="keyword">fun</span>&nbsp;()&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="string">"Grdfs.is_a_&nbsp;iri="</span>^(<span class="constructor">Rdf_iri</span>.string&nbsp;iri));<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;obj&nbsp;=&nbsp;<span class="constructor">Iri</span>&nbsp;iri&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;sub&nbsp;=&nbsp;<span class="constructor">Iri</span>&nbsp;sub&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;is_a&nbsp;wld&nbsp;~sub&nbsp;~obj<br>
;;<br>
<br>
<span class="keyword">let</span>&nbsp;is_a_tool&nbsp;=&nbsp;is_a_&nbsp;genet_tool;;<br>
<span class="keyword">let</span>&nbsp;is_a_branch&nbsp;=&nbsp;is_a_&nbsp;genet_branch;;<br>
<span class="keyword">let</span>&nbsp;is_a_version&nbsp;=&nbsp;is_a_&nbsp;genet_version;;<br>
<span class="keyword">let</span>&nbsp;is_a_intf&nbsp;=&nbsp;is_a_&nbsp;genet_intf;;<br>
<span class="keyword">let</span>&nbsp;is_a_filetype&nbsp;=&nbsp;is_a_&nbsp;genet_filetype;;<br>
<span class="keyword">let</span>&nbsp;is_a_instopn&nbsp;=&nbsp;is_a_&nbsp;genet_instopn;;<br>
<span class="keyword">let</span>&nbsp;is_a_diffcommand&nbsp;=&nbsp;is_a_&nbsp;genet_diffcommand;;<br>
<br>
<span class="keyword">let</span>&nbsp;is_iri_for_&nbsp;f_is&nbsp;string&nbsp;wld&nbsp;iri&nbsp;=<br>
&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;iri_basename&nbsp;iri&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;s&nbsp;<span class="keyword">when</span>&nbsp;s&nbsp;=&nbsp;string&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">begin</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;iri&nbsp;=&nbsp;iri_parent&nbsp;iri&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;f_is&nbsp;wld&nbsp;iri&nbsp;<span class="keyword">then</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Some</span>&nbsp;iri<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">None</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">None</span>;;<br>
<br>
<span class="keyword">let</span>&nbsp;is_iri_tool_&nbsp;=&nbsp;is_iri_for_&nbsp;is_a_tool;;<br>
<span class="keyword">let</span>&nbsp;is_iri_tool_versions&nbsp;=&nbsp;is_iri_tool_&nbsp;<span class="string">"versions"</span>;;<br>
<span class="keyword">let</span>&nbsp;is_iri_tool_interfaces&nbsp;=&nbsp;is_iri_tool_&nbsp;<span class="string">"interfaces"</span>;;<br>
<span class="keyword">let</span>&nbsp;is_iri_tool_branches&nbsp;=&nbsp;is_iri_tool_&nbsp;<span class="string">"branches"</span>;;<br>
<br>
<span class="keyword">let</span>&nbsp;is_iri_branch_&nbsp;=&nbsp;is_iri_for_&nbsp;is_a_branch;;<br>
<span class="keyword">let</span>&nbsp;is_iri_branch_versions&nbsp;=&nbsp;is_iri_branch_&nbsp;<span class="string">"versions"</span>;;<br>
<span class="keyword">let</span>&nbsp;is_iri_branch_interfaces&nbsp;=&nbsp;is_iri_branch_&nbsp;<span class="string">"interfaces"</span>;;<br>
<span class="keyword">let</span>&nbsp;is_iri_branch_branches&nbsp;=&nbsp;is_iri_branch_&nbsp;<span class="string">"branches"</span>;;<br>
<br>
<span class="keyword">let</span>&nbsp;is_iri_version_interfaces&nbsp;=&nbsp;is_iri_for_&nbsp;is_a_version&nbsp;<span class="string">"interfaces"</span>;;<br>
<br>
<span class="keyword">let</span>&nbsp;add_name&nbsp;wld&nbsp;sub&nbsp;name&nbsp;=<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;pred&nbsp;=&nbsp;genet_name&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;obj&nbsp;=&nbsp;<span class="constructor">Rdf_term</span>.term_of_literal_string&nbsp;name&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;add_triple&nbsp;wld&nbsp;~sub&nbsp;~pred&nbsp;~obj<br>
;;<br>
<br>
<span class="keyword">let</span>&nbsp;add_desc&nbsp;wld&nbsp;sub&nbsp;desc&nbsp;=<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;pred&nbsp;=&nbsp;genet_desc&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;obj&nbsp;=&nbsp;<span class="constructor">Rdf_term</span>.term_of_literal_string&nbsp;desc&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;add_triple&nbsp;wld&nbsp;~sub&nbsp;~pred&nbsp;~obj<br>
;;<br>
<br>
<span class="keyword">let</span>&nbsp;object_literals&nbsp;wld&nbsp;~sub&nbsp;~pred&nbsp;=<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;wld.wld_graph.objects_of&nbsp;~sub&nbsp;~pred&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;acc&nbsp;=&nbsp;<span class="keyword">function</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Literal</span>&nbsp;lit&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;lit.lit_value&nbsp;::&nbsp;acc<br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;acc<br>
&nbsp;&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="constructor">List</span>.fold_left&nbsp;f&nbsp;[]&nbsp;l<br>
;;<br>
<br>
<span class="keyword">let</span>&nbsp;object_literal&nbsp;wld&nbsp;~sub&nbsp;~pred&nbsp;=<br>
&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;object_literals&nbsp;wld&nbsp;~sub&nbsp;~pred&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">None</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;s&nbsp;::&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Some</span>&nbsp;s<br>
;;<br>
<br>
<span class="keyword">let</span>&nbsp;name&nbsp;wld&nbsp;source&nbsp;=<br>
&nbsp;&nbsp;<span class="constructor">Misc</span>.string_of_opt&nbsp;(object_literal&nbsp;wld&nbsp;source&nbsp;genet_name)<br>
;;<br>
<br>
<span class="keyword">let</span>&nbsp;name_of_iri_string&nbsp;wld&nbsp;source&nbsp;=<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;iri&nbsp;=&nbsp;<span class="constructor">Rdf_term</span>.term_of_iri_string&nbsp;source&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;name&nbsp;wld&nbsp;iri<br>
;;<br>
<br>
<span class="keyword">let</span>&nbsp;desc&nbsp;wld&nbsp;source&nbsp;=<br>
&nbsp;&nbsp;<span class="constructor">Misc</span>.string_of_opt&nbsp;(object_literal&nbsp;wld&nbsp;source&nbsp;genet_desc)<br>
;;<br>
<br>
<span class="keyword">let</span>&nbsp;subjects&nbsp;wld&nbsp;~pred&nbsp;~obj&nbsp;=&nbsp;wld.wld_graph.subjects_of&nbsp;~pred&nbsp;~obj;;<br>
<span class="keyword">let</span>&nbsp;objects&nbsp;wld&nbsp;~sub&nbsp;~pred&nbsp;=&nbsp;wld.wld_graph.objects_of&nbsp;~sub&nbsp;~pred;;<br>
<br>
<span class="keyword">let</span>&nbsp;subject_iris&nbsp;wld&nbsp;~pred&nbsp;~obj&nbsp;=<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;wld.wld_graph.subjects_of&nbsp;~pred&nbsp;~obj&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;acc&nbsp;=&nbsp;<span class="keyword">function</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Iri</span>&nbsp;iri&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;iri&nbsp;::&nbsp;acc<br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;acc<br>
&nbsp;&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="constructor">List</span>.fold_left&nbsp;f&nbsp;[]&nbsp;l<br>
;;<br>
<br>
<span class="keyword">let</span>&nbsp;subject_iri&nbsp;wld&nbsp;~pred&nbsp;~obj&nbsp;=<br>
&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;subject_iris&nbsp;wld&nbsp;~pred&nbsp;~obj&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">None</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;iri&nbsp;::&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Some</span>&nbsp;iri<br>
;;<br>
<br>
<span class="keyword">let</span>&nbsp;object_iris&nbsp;wld&nbsp;~sub&nbsp;~pred&nbsp;=<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;wld.wld_graph.objects_of&nbsp;~sub&nbsp;~pred&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;acc&nbsp;=&nbsp;<span class="keyword">function</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Iri</span>&nbsp;iri&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;iri&nbsp;::&nbsp;acc<br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;acc<br>
&nbsp;&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="constructor">List</span>.fold_left&nbsp;f&nbsp;[]&nbsp;l<br>
;;<br>
<br>
<span class="keyword">let</span>&nbsp;object_iri&nbsp;wld&nbsp;~sub&nbsp;~pred&nbsp;=<br>
&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;object_iris&nbsp;wld&nbsp;~sub&nbsp;~pred&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">None</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;iri&nbsp;::&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Some</span>&nbsp;iri<br>
;;<br>
<br>
<span class="keyword">let</span>&nbsp;remove_date_iri_&nbsp;pred&nbsp;wld&nbsp;sub&nbsp;=<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;sub&nbsp;=&nbsp;<span class="constructor">Iri</span>&nbsp;sub&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;wld.wld_graph.objects_of&nbsp;~sub&nbsp;~pred&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;obj&nbsp;=&nbsp;rem_triple&nbsp;wld&nbsp;~sub&nbsp;~pred&nbsp;~obj&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="constructor">List</span>.iter&nbsp;f&nbsp;l<br>
;;<br>
<br>
<span class="keyword">let</span>&nbsp;set_date_iri_&nbsp;pred&nbsp;wld&nbsp;sub&nbsp;?d&nbsp;()&nbsp;=<br>
&nbsp;&nbsp;remove_date_iri_&nbsp;pred&nbsp;wld&nbsp;sub;<br>
&nbsp;&nbsp;add_triple&nbsp;wld<br>
&nbsp;&nbsp;&nbsp;&nbsp;~sub:&nbsp;(<span class="constructor">Iri</span>&nbsp;sub)&nbsp;~pred<br>
&nbsp;&nbsp;&nbsp;&nbsp;~obj:&nbsp;(<span class="constructor">Rdf_term</span>.term_of_datetime&nbsp;?d&nbsp;())<br>
;;<br>
<span class="keyword">let</span>&nbsp;date_iri_&nbsp;pred&nbsp;wld&nbsp;sub&nbsp;=<br>
&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;wld.wld_graph.objects_of&nbsp;~sub:(<span class="constructor">Iri</span>&nbsp;sub)&nbsp;~pred&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">None</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;[<span class="constructor">Literal</span>&nbsp;lit]&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Some</span>&nbsp;(<span class="constructor">Rdf_term</span>.datetime_of_literal&nbsp;lit)<br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;failwith&nbsp;(<span class="constructor">Printf</span>.sprintf&nbsp;<span class="string">"Invalid&nbsp;%s&nbsp;object"</span>&nbsp;(<span class="constructor">Rdf_iri</span>.string&nbsp;pred))<br>
<br>
<span class="keyword">let</span>&nbsp;remove_creation_date_iri&nbsp;=&nbsp;remove_date_iri_&nbsp;genet_createdon;;<br>
<span class="keyword">let</span>&nbsp;set_creation_date_iri&nbsp;=&nbsp;set_date_iri_&nbsp;genet_createdon;;<br>
<span class="keyword">let</span>&nbsp;creation_date_iri&nbsp;=&nbsp;date_iri_&nbsp;genet_createdon&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;remove_start_date_iri&nbsp;=&nbsp;remove_date_iri_&nbsp;genet_startedon;;<br>
<span class="keyword">let</span>&nbsp;set_start_date_iri&nbsp;=&nbsp;set_date_iri_&nbsp;genet_startedon;;<br>
<span class="keyword">let</span>&nbsp;start_date_iri&nbsp;=&nbsp;date_iri_&nbsp;genet_startedon&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;remove_stop_date_iri&nbsp;=&nbsp;remove_date_iri_&nbsp;genet_stoppedon;;<br>
<span class="keyword">let</span>&nbsp;set_stop_date_iri&nbsp;=&nbsp;set_date_iri_&nbsp;genet_stoppedon;;<br>
<span class="keyword">let</span>&nbsp;stop_date_iri&nbsp;=&nbsp;date_iri_&nbsp;genet_stoppedon&nbsp;;;<br>
<br>
<span class="keyword">let</span>&nbsp;remove_command_output&nbsp;wld&nbsp;iri&nbsp;=<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;sub&nbsp;=&nbsp;<span class="constructor">Iri</span>&nbsp;iri&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;pred&nbsp;=&nbsp;genet_commandoutput&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;wld.wld_graph.objects_of&nbsp;~sub&nbsp;~pred&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;obj&nbsp;=&nbsp;rem_triple&nbsp;wld&nbsp;~sub&nbsp;~pred&nbsp;~obj&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="constructor">List</span>.iter&nbsp;f&nbsp;l<br>
;;<br>
<span class="keyword">let</span>&nbsp;command_output&nbsp;wld&nbsp;iri&nbsp;=<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;sub&nbsp;=&nbsp;<span class="constructor">Iri</span>&nbsp;iri&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;pred&nbsp;=&nbsp;genet_commandoutput&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;object_literal&nbsp;wld&nbsp;~sub&nbsp;~pred<br>
;;<br>
<span class="keyword">let</span>&nbsp;set_command_output&nbsp;wld&nbsp;iri&nbsp;s&nbsp;=<br>
&nbsp;&nbsp;&nbsp;remove_command_output&nbsp;wld&nbsp;iri;<br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;sub&nbsp;=&nbsp;<span class="constructor">Iri</span>&nbsp;iri&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;pred&nbsp;=&nbsp;genet_commandoutput&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;obj&nbsp;=&nbsp;<span class="constructor">Rdf_term</span>.term_of_literal_string&nbsp;s&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;add_triple&nbsp;wld&nbsp;~sub&nbsp;~pred&nbsp;~obj<br>
;;<br>
<br>
<span class="keyword">let</span>&nbsp;remove_is_active_iri&nbsp;wld&nbsp;sub&nbsp;=<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;sub&nbsp;=&nbsp;<span class="constructor">Iri</span>&nbsp;sub&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;pred&nbsp;=&nbsp;genet_isactive&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;l&nbsp;=&nbsp;wld.wld_graph.objects_of&nbsp;~sub&nbsp;~pred&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;obj&nbsp;=&nbsp;rem_triple&nbsp;wld&nbsp;~sub&nbsp;~pred&nbsp;~obj&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="constructor">List</span>.iter&nbsp;f&nbsp;l<br>
;;<br>
<br>
<span class="keyword">let</span>&nbsp;set_is_active_iri&nbsp;wld&nbsp;sub&nbsp;b&nbsp;=<br>
&nbsp;&nbsp;remove_is_active_iri&nbsp;wld&nbsp;sub;<br>
&nbsp;&nbsp;add_triple&nbsp;wld<br>
&nbsp;&nbsp;&nbsp;&nbsp;~sub:&nbsp;(<span class="constructor">Iri</span>&nbsp;sub)&nbsp;~pred:&nbsp;genet_isactive<br>
&nbsp;&nbsp;&nbsp;&nbsp;~obj:&nbsp;(<span class="constructor">Rdf_term</span>.term_of_bool&nbsp;b)<br>
;;<br>
<br>
<span class="keyword">let</span>&nbsp;is_active_iri&nbsp;wld&nbsp;sub&nbsp;=<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;pred&nbsp;=&nbsp;genet_isactive&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;wld.wld_graph.objects_of&nbsp;~sub:(<span class="constructor">Iri</span>&nbsp;sub)&nbsp;~pred&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;[]&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">true</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;[<span class="constructor">Literal</span>&nbsp;lit]&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Rdf_term</span>.bool_of_literal&nbsp;lit<br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;failwith&nbsp;<span class="string">"Invalid&nbsp;isactive&nbsp;object"</span><br>
;;<br>
<br>
<span class="comment">(*<br>
let&nbsp;fold_target_sequence&nbsp;f&nbsp;acc&nbsp;wld&nbsp;~source&nbsp;~pred&nbsp;=<br>
&nbsp;&nbsp;let&nbsp;sparql&nbsp;=<br>
&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;Rdf_sparql.select_proj&nbsp;=&nbsp;[&nbsp;"seq_index"&nbsp;;&nbsp;"iri"&nbsp;];<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select_distinct&nbsp;=&nbsp;None&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select_where&nbsp;=<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;([<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(`I&nbsp;source,&nbsp;[&nbsp;`I&nbsp;pred,&nbsp;[`V&nbsp;"seq"]&nbsp;])&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(`V&nbsp;"seq",&nbsp;[&nbsp;`V&nbsp;"seq_index",&nbsp;[`V&nbsp;"iri"]&nbsp;])&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],&nbsp;None)<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;in<br>
&nbsp;&nbsp;let&nbsp;qf&nbsp;acc&nbsp;qr&nbsp;=<br>
&nbsp;&nbsp;&nbsp;&nbsp;match<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Rdf_query_results.get_binding_value_by_name&nbsp;qr&nbsp;"seq_index",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Rdf_query_results.get_binding_value_by_name&nbsp;qr&nbsp;"iri"<br>
&nbsp;&nbsp;&nbsp;&nbsp;with<br>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;None,&nbsp;_&nbsp;|&nbsp;_,&nbsp;None&nbsp;-&gt;&nbsp;acc<br>
&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Some&nbsp;index_node,&nbsp;Some&nbsp;iri_node&nbsp;-&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;n&nbsp;=&nbsp;Rdf_node.get_li_ordinal&nbsp;index_node&nbsp;in<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;acc&nbsp;n&nbsp;iri_node<br>
&nbsp;&nbsp;in<br>
&nbsp;&nbsp;Rdf_sparql.select_and_fold&nbsp;wld.wld_world&nbsp;wld.wld_model&nbsp;sparql&nbsp;qf&nbsp;acc<br>
;;<br>
*)</span><br>
<br>
<span class="comment">(*<br>
let&nbsp;delete_from_sparql&nbsp;wld&nbsp;query&nbsp;=<br>
&nbsp;&nbsp;prerr_endline<br>
&nbsp;&nbsp;(Printf.sprintf&nbsp;"delete&nbsp;from&nbsp;sparql&nbsp;query=%s"&nbsp;(Rdf_sparql.string_of_construct&nbsp;query));<br>
&nbsp;&nbsp;let&nbsp;_stream&nbsp;=&nbsp;Rdf_sparql.exec_construct&nbsp;wld&nbsp;query&nbsp;in<br>
&nbsp;&nbsp;assert&nbsp;false<br>
&nbsp;&nbsp;(*Rdf_stream.iter<br>
&nbsp;&nbsp;(fun&nbsp;st&nbsp;-&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prerr_endline&nbsp;(Rdf_statement.to_string&nbsp;st);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Rdf_model.remove_statement&nbsp;wld.wld_model&nbsp;st<br>
&nbsp;&nbsp;)<br>
&nbsp;&nbsp;stream*)<br>
;;<br>
*)</span><br>
<br>
<span class="keyword">let</span>&nbsp;class_of&nbsp;wld&nbsp;sub&nbsp;=<br>
&nbsp;&nbsp;object_iri&nbsp;wld&nbsp;~sub&nbsp;~pred:&nbsp;rdf_type;;<br>
<br>
<span class="keyword">let</span>&nbsp;class_of_iri_string&nbsp;wld&nbsp;iri&nbsp;=<br>
&nbsp;&nbsp;class_of&nbsp;wld&nbsp;(<span class="constructor">Rdf_term</span>.term_of_iri_string&nbsp;iri)<br>
;;<br>
<br>
<br>
</code></body></html>